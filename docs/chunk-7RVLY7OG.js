import{b as C,c as T,g as S,l as w,n as A,p as G}from"./chunk-OGIE4W3D.js";import{Ea as d,Fa as h,Ha as x,Ia as f,M as p,N as b,R as v,S as i,r as u,wa as g,xa as _}from"./chunk-BDIL7F3U.js";var a=class{};var s=class o{constructor(t){this._authGatewayService=t}getCode(){return this._authGatewayService.getCode()}getToken(t){return this._authGatewayService.getToken(t)}callProxy(t){return this._authGatewayService.callProxy(t)}static \u0275fac=function(e){return new(e||o)(v(a))};static \u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})};var n={redirectUri:"https://boterosalas.github.io/leads-ml/",clientId:"8315944344732576"};var l=class o{_authUsecaseService=i(s);_activatedRoute=i(w);_router=i(A);_location=i(C);ngOnInit(){this.listenToCode()}getCode(){console.log("getCode desde el componente"),this._authUsecaseService.getCode()}listenToCode(){this._activatedRoute.queryParams.subscribe(t=>{let e=t.code||null;e&&(console.log("code",e),this.reInitUrl(),this.getToken(e))})}getToken(t){this._authUsecaseService.getToken(t).subscribe(e=>{console.log({data:e})})}reInitUrl(){console.log("reInitUrl"),this._location.replaceState(this._router.url.split("?")[0])}callProxy(){let t={method:"POST",url:"https://api.mercadolibre.com/oauth/token",data:{code:"TG-68b8f5346421e700011698d2-2651263697",grant_type:"authorization_code",redirect_uri:n.redirectUri,client_id:"8315944344732576",client_secret:"rAsZB2GwlsivbGp4GE5CANWw0ulMTizu"},headers:{"Content-Type":"application/json"}};this._authUsecaseService.callProxy(t).subscribe({next:e=>{console.log(e)},error:e=>{console.error("Error desde proxy:",e)}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-auth"]],decls:4,vars:0,consts:[[3,"click"]],template:function(e,r){e&1&&(d(0,"h1"),f(1,"Auth"),h(),d(2,"button",0),x("click",function(){return r.getCode()}),f(3,"getCode"),h())},encapsulation:2})};var P=[{path:"",component:l}];var m=class o{_httpClient=i(S);apiUrl="https://2o8i6bmmue.execute-api.us-east-1.amazonaws.com/MeliDevStage/trigger";getCode(){console.log("getCode desde el servicio"),window.location.href=`https://auth.mercadolibre.com.co/authorization?response_type=code&client_id=${n.clientId}&redirect_uri=${n.redirectUri}`}getToken(t){let e={code:t,grant_type:"authorization_code",client_id:"8315944344732576",redirect_uri:"https://boterosalas.github.io/leads-ml/",client_secret:"rAsZB2GwlsivbGp4GE5CANWw0ulMTizu"};return this._httpClient.post("https://2o8i6bmmue.execute-api.us-east-1.amazonaws.com/MeliDevStage/trigger",e).pipe(u(r=>{let c;try{c=typeof r.body=="string"?JSON.parse(r.body):r.body}catch{c=r.body}return c}))}callProxy(t){return this._httpClient.post("https://2o8i6bmmue.execute-api.us-east-1.amazonaws.com/MeliDevStage/trigger",{code:"TG-68ba67191dfc2a000103d295-2651263697",grant_type:"authorization_code",client_id:"8315944344732576",redirect_uri:"https://boterosalas.github.io/leads-ml/",client_secret:"rAsZB2GwlsivbGp4GE5CANWw0ulMTizu"}).pipe(u(e=>{let r;try{r=typeof e.body=="string"?JSON.parse(e.body):e.body}catch{r=e.body}return r}))}static \u0275fac=function(e){return new(e||o)};static \u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})};var R=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=_({type:o});static \u0275inj=b({providers:[s,{provide:a,useClass:m}],imports:[T,G.forChild(P)]})};export{R as AuthModule};
