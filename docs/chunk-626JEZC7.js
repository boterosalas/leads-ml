import{b as _,c as A,g as x,l as T,n as S,p as w}from"./chunk-OGIE4W3D.js";import{Ea as c,Fa as m,Ha as h,Ia as p,M as a,N as y,R as b,S as r,r as v,wa as g,xa as C}from"./chunk-BDIL7F3U.js";var n=class{};var s=class o{constructor(t){this._authGatewayService=t}getCode(){return this._authGatewayService.getCode()}getAccessToken(t){return this._authGatewayService.getAccessToken(t)}useProxy(t){return this._authGatewayService.useProxy(t)}static \u0275fac=function(e){return new(e||o)(b(n))};static \u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"})};var u=class o{_authUsecaseService=r(s);_activatedRoute=r(T);_router=r(S);_location=r(_);ngOnInit(){this.listenToCode()}getCode(){console.log("getCode desde el componente"),this._authUsecaseService.getCode()}listenToCode(){this._activatedRoute.queryParams.subscribe(t=>{let e=t.code||null;e&&(console.log("code",e),this.reInitUrl(),this.getAccessToken(e))})}getAccessToken(t){this._authUsecaseService.getAccessToken(t).subscribe(e=>{console.log({data:e})})}reInitUrl(){console.log("reInitUrl"),this._location.replaceState(this._router.url.split("?")[0])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-auth"]],decls:6,vars:0,consts:[[3,"click"]],template:function(e,i){e&1&&(c(0,"h1"),p(1,"Auth"),m(),c(2,"button",0),h("click",function(){return i.getCode()}),p(3,"getCode"),m(),c(4,"button",0),h("click",function(){return i.getCode()}),p(5,"getLeads"),m())},encapsulation:2})};var R=[{path:"",component:u}];var l={redirectUri:"https://boterosalas.github.io/leads-ml/",clientId:"8315944344732576"};var d=class o{_httpClient=r(x);apiUrl="https://2o8i6bmmue.execute-api.us-east-1.amazonaws.com/MeliDevStage/trigger";getCode(){console.log("getCode desde el servicio"),window.location.href=`https://auth.mercadolibre.com.co/authorization?response_type=code&client_id=${l.clientId}&redirect_uri=${l.redirectUri}`}getAccessToken(t){let e={method:"POST",url:"https://api.mercadolibre.com/oauth/token",data:{code:t,grant_type:"authorization_code",redirect_uri:l.redirectUri,client_id:"8315944344732576",client_secret:"rAsZB2GwlsivbGp4GE5CANWw0ulMTizu"},headers:{"Content-Type":"application/json"}};return this.useProxy(e)}useProxy(t){return this._httpClient.post(this.apiUrl,t).pipe(v(e=>{let i;try{i=typeof e.body=="string"?JSON.parse(e.body):e.body}catch{i=e.body}return i}))}static \u0275fac=function(e){return new(e||o)};static \u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"})};var P=class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=C({type:o});static \u0275inj=y({providers:[s,{provide:n,useClass:d}],imports:[A,w.forChild(R)]})};export{P as AuthModule};
